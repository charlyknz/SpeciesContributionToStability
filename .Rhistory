theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16))
delta.pi.plot2
delta.pi.plot1<-ggplot(subset(data3, Limit == 'Limit1' & runNumber == 3), aes(x=timepoint, y=delta.pi,
col=species)) +
geom_hline(yintercept=0, col="grey")+
geom_vline(xintercept=0, col="grey")+
theme(legend.position="bottom")+
scale_color_manual(values = c('#68789E', '#68789E', '#68789E', '#68789E', '#68789E'))+
geom_line()+
xlab("time") +  ylab ("proportion")+
facet_grid(~Model)+
theme_bw() +
theme(legend.position = 'none')+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16))
delta.pi.plot1
plot_grid(delta.pi.plot1, delta.pi.plot2, delta.pi.plot3, ncol = 1)
LRR.plot<-ggplot(subset(data3, Limit == 'Limit1' & runNumber == 3), aes(x=timepoint, y=RR,
col=species)) +
geom_hline(yintercept=0, col="grey")+
theme(legend.position="bottom")+
scale_color_manual(values = c('#68789E', '#68789E', '#68789E', '#68789E', '#68789E'))+
geom_line()+
xlab("time") +  ylab ("RR")+
facet_grid(~Model)+
theme_bw() +
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16))
LRR.plot
Lim1LRR<-ggplot(subset(data3, Limit == 'Limit1' & runNumber == 3), aes(x=timepoint, y=growth,col=species)) +
geom_line()+
scale_color_manual(values = c('#68789E', '#68789E', '#68789E', '#68789E', '#68789E'))+
labs(x= ' ',  y = " ")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 12)) +
theme(legend.position="none")
Lim1LRR
Lim2LRR<-ggplot(subset(data3, Limit == 'Limit2' & runNumber == 40), aes(x=timepoint, y=growth,
col=species)) +
scale_color_manual(values = c('#68789E', '#C6C6C680', '#C6C6C680', '#C6C6C680', '#C6C6C680'))+
geom_line()+
labs( x= ' ', y = "biomass")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 12)) +
theme(legend.position="none")
Lim2LRR
Lim3LRR<-ggplot(subset(data3, Limit == 'Limit3'&runNumber == 27), aes(x=timepoint, y=growth,
col=species)) +
geom_line()+
scale_color_manual(values = c('#D56060', '#C6C6C680', '#C6C6C680', '#C6C6C680', '#C6C6C680'))+
labs(x = 'time', y = " ")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 12)) +  theme(legend.position="none")
Lim3LRR
plot_grid(Lim1LRR, Lim2LRR, Lim3LRR,ncol = 1, nrow = 3, vjust = 1.7,hjust=0.05,label_size = 10,labels = c('Limit1', 'Limit2', 'Limit3'), rel_widths = c(1,1))
plot_grid(Lim1LRR, Lim2LRR, Lim3LRR,ncol = 1, nrow = 3, vjust = 1.7,hjust=0.05,label_size = 10,labels = c('Limit1', 'Limit2', 'Limit3'), rel_widths = c(1,1))
ggsave(plot = last_plot(), width = 8, height = 7, file = here('output/Fig.1_Biomass.png'))
### create USI ####
auc <- data3 %>%
mutate(USI = paste(Limit, species,runNumber,Model, sep = "_")) %>% #create unique ID
drop_na(LRR)
which(is.infinite(auc$deltabm.tot))
str(auc)
#order data after time
auc <-auc[with(auc, order(USI, timepoint)),]
#First sampling needs to be 0 in order to use the AUC function
#auc$timepoint <- ifelse(auc$timepoint == 0.0, 0, auc$timepoint)
str(auc)
#create vector with the unique ID
USI<-unique(auc$USI)# USI is the identifier for the experimental unit
head(USI)
#### calculate Area Under the Curve  ####
stab.auc <- data.frame()#opens empty data frame
# the following loop cycles through all unique case
#### AUC Loop ####
for(i in 1:length(USI)){
temp<-auc[auc$USI==USI[i], ]#creates a temporary data frame for each case
{
AUC.pi<- auc(temp$timepoint, temp$delta.pi, from = min(temp$timepoint, na.rm = T), to = max(temp$timepoint,na.rm = T), type = c("spline"),absolutearea = FALSE, na.rm = T)
AUC.RR<-auc(temp$timepoint, temp$RR,  from = min(temp$timepoint, na.rm = T), to = max(temp$timepoint,na.rm = T),type = c("spline"),absolutearea = FALSE, na.rm = FALSE)
AUC.totRR<-auc(temp$timepoint,temp$deltabm.tot, from = min(temp$timepoint, na.rm = T), to = max(temp$timepoint,na.rm = T),
type = c("spline"),absolutearea = FALSE,  na.rm = FALSE)
mean.delta.pi<-mean(temp$delta.pi)
mean.RR<-mean(temp$RR)
mean.pi<-mean(temp$mean.pi)
mean.con.pi <- mean(temp$con.pi)
mean.treat.pi <- mean(temp$treat.pi)
sd.delta.pi<-sd(temp$delta.pi)
sd.RR<-sd(temp$RR)
stab.auc<-rbind(stab.auc,
data.frame(temp,
AUC.RR,
AUC.pi,
AUC.totRR,mean.con.pi, mean.treat.pi,
mean.delta.pi,mean.RR,mean.pi,
sd.delta.pi,sd.RR))
}
}
plot_grid(Lim1LRR, Lim2LRR, Lim3LRR,ncol = 1, nrow = 3, vjust = 1.7,hjust=0.05,label_size = 10,labels = c('a)', 'b)', 'c)'), rel_widths = c(1,1))
ggsave(plot = last_plot(), width = 8, height = 7, file = here('output/Fig.1_Biomass.png'))
plot_grid(Lim1LRR, Lim2LRR, Lim3LRR,ncol = 1, nrow = 3, vjust = 1.7,hjust=0.05,label_size = 10,labels = c('a)', 'b)', 'c)'), rel_widths = c(1,1))
ggsave(plot = last_plot(), width = 8, height = 7, file = here('output/Fig.1_Biomass.png'))
####load packages ####
#library(reshape2)
library(tidyverse)
library(nlme)
library(ggpubr)
library(psych)
library(cowplot)
# import data
Stab_Alpha_AUC_M5<- read.csv('BEFD_createdData/StabAlphaAUC.csv')
#### Data wrangling ####
stab.alpha <- Stab_Alpha_AUC_M5 %>%
mutate(maximum = max(competition), #calculate maximum alpha
relAlpha= maximum/competition) %>%# to measure relative competitiveness calculate 1/relAlpha
distinct(species,relAlpha,Limit, sensitivity, runNumber, Model, AUC.RR, AUC.pi) %>%
mutate(runID = paste(Model, runNumber, sep = '_'))
names(stab.alpha)
stab.alpha$Model[stab.alpha$Model == 'press']<- 'Press'
stab.alpha$Model[stab.alpha$Model == 'pulse']<- 'Pulse'
stab.alpha$Model[stab.alpha$Model == 'pulsepress']<- 'Pulse & Press'
# change in biomass and alpha
Lim1RRpi<-ggplot(subset(stab.alpha, Limit == 'Limit1'), aes(x=AUC.pi, y=AUC.RR,
col=species,
size= relAlpha)) +
geom_hline(yintercept=0, col="grey")+
geom_vline(xintercept=0, col="grey")+
geom_point(alpha= .3)+
scale_color_manual(values = c('#68789E', '#68789E', '#68789E', '#68789E', '#68789E'))+
scale_y_continuous(limits = c(-6, 6), breaks = c(-4,-2,0,2,4))+
scale_x_continuous(limits = c(-3, 3), breaks = c(-2,0,2))+
labs(x = '',y = " ")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Lim1RRpi
unique(stab.alpha$species)
Lim2RRpi<-ggplot(subset(stab.alpha, Limit == 'Limit2'), aes(x=AUC.pi, y=AUC.RR,
col=species,
size= relAlpha)) +
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_y_continuous(limits = c(-27, 27), breaks = c(-20,-10,0,10,20))+
scale_x_continuous(limits = c(-4, 4), breaks = c(-3,0,3))+
geom_point(alpha= .3)+
geom_hline(yintercept=0, col="grey")+
geom_vline(xintercept=0, col="grey")+
labs(x = '', y = "Absolute contribution to stability")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Lim2RRpi
Lim3RRpi<-ggplot(subset(stab.alpha, Limit == 'Limit3'), aes(x=AUC.pi, y=AUC.RR,
col=species,
size= relAlpha)) +
geom_point(alpha= .3)+
geom_hline(yintercept=0, col="grey")+
geom_vline(xintercept=0, col="grey")+
scale_color_manual(values = c('#D56060', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_y_continuous(limits = c(-33, 33), breaks = c(-30,-15,0,15,30))+
scale_x_continuous(limits = c(-4, 4), breaks = c(-2,0,2))+
labs(x = 'Relative contribution to stability', y = " ")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +  theme(legend.position="none")
Lim3RRpi
par(mar=c (5.1, 4.1, 4.1, 2.1))
ggarrange(Lim1RRpi, Lim2RRpi, Lim3RRpi,ncol = 1, nrow = 3, vjust = 3.7,hjust=-1.5,widths = c(1,1))
ggsave(plot = last_plot(), width = 9, height = 9, file = here('ouptut/Fig.2_DistTypes_auc.png'))
ggsave(plot = last_plot(), width = 9, height = 9, file = here('output/Fig.2_DistTypes_auc.png'))
hist(stab.alpha$relAlpha)
#### Supplement Figure: relative competitiveness plot ####
Lim1R<-ggplot(subset(stab.alpha, Limit == 'Limit1'), aes(x=relAlpha, y=AUC.RR,
col=species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .3, size = 2)+
scale_color_manual(values = c('#68789E', '#68789E', '#68789E', '#68789E', '#68789E'))+
labs(y = 'Absolute contribution to stability', x = "")+
facet_wrap(~Model, ncol = 3)+
scale_y_continuous(limits = c(-1.7, 1.1), breaks = c(-1.5,-1,-0.5,0,0.5,1))+
scale_x_continuous(limits = c(0.99, 1.17), breaks = c(1,1.05,1.10,1.15))+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Lim1R
Lim1pi<-ggplot(subset(stab.alpha, Limit == 'Limit1'), aes(x=relAlpha, y=AUC.pi,
col=species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .3, size = 2)+
scale_color_manual(values = c('#68789E', '#68789E', '#68789E', '#68789E', '#68789E'))+
scale_y_continuous(limits = c(-0.1, 0.1), breaks = c(-0.1,-0.05,0,0.05,0.1))+
scale_x_continuous(limits = c(0.99, 1.17), breaks = c(1,1.05,1.10,1.15))+
labs(y = 'Relative contribution to stability', x = " ")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Lim1pi
unique(stab.alpha$species)
Lim2R<-ggplot(subset(stab.alpha, Limit == 'Limit2'), aes(x=relAlpha, y=AUC.RR,
col=species)) +
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_y_continuous(limits = c(-33, 33), breaks = c(-30,-15,0,15,30))+
scale_x_continuous(limits = c(0.99, 1.17), breaks = c(1,1.05,1.10,1.15))+
geom_point(alpha= .3, size = 2)+
geom_hline(yintercept=0, col="grey")+
labs(y = 'Absolute contribution to stability', x = " ")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Lim2R
Lim2pi<-ggplot(subset(stab.alpha, Limit == 'Limit2'), aes(x=relAlpha, y=AUC.pi,
col=species)) +
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_y_continuous(limits = c(-4, 4), breaks = c(-4,-2,0,2,4))+
scale_x_continuous(limits = c(0.99, 1.17), breaks = c(1,1.05,1.10,1.15))+
geom_point(alpha= .3, size = 2)+
geom_hline(yintercept=0, col="grey")+
labs(y = 'Relative contribution to stability', x = "")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Lim2pi
Lim3R<-ggplot(subset(stab.alpha, Limit == 'Limit3'), aes(x=relAlpha, y=AUC.RR,
col=species)) +
geom_point(alpha= .3, size = 2)+
geom_hline(yintercept=0, col="grey")+
scale_color_manual(values = c('#D56060', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_x_continuous(limits = c(0.99, 1.17), breaks = c(1,1.05,1.10,1.15))+
scale_y_continuous(limits = c(-30, 25), breaks = c(-30,-20,-10,0,10,20))+
labs(y='Absolute contribution to stability', x = "relative competitiveness")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(text = element_text(size = 16)) +  theme(legend.position="none")
Lim3R
Lim3pi<-ggplot(subset(stab.alpha, Limit == 'Limit3'), aes(x=relAlpha, y=AUC.pi,
col=species)) +
geom_point(alpha= .3, size = 2)+
geom_hline(yintercept=0, col="grey")+
scale_color_manual(values = c('#D56060', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_x_continuous(limits = c(0.99, 1.17), breaks = c(1,1.05,1.10,1.15))+
scale_y_continuous(limits = c(-3, 2.5), breaks = c(-3,-2,-1,0,1,2))+
labs(y= 'Relative contribution to stability', x = "relative competitiveness")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(text = element_text(size = 16)) +  theme(legend.position="")
Lim3pi#ggsave(plot = RRpi, 'RRPi.png',width = 8, height = 4)
par(mar=c (5.1, 4.1, 4.1, 2.1))
ggarrange(Lim1R,Lim1pi,  Lim2R,Lim2pi,Lim3R,Lim3pi,hjust = -1, ncol = 2, nrow = 3)
ggsave(plot = last_plot(), width = 12, height = 12, file = here('output/Supplement_AllDist.png'))
#load packages and functions
library(tidyverse)
library(ggpubr)
library(cowplot)
library(ggpmisc) #for regression lines
setwd("~/Desktop/BEFD22/BEFDisturbance/Untitled/modelOutput")
library(here)
setwd("~/Desktop/phD/SpeciesContributionToStability")
#### stabAlphaAUC dataset ####
max<- read.csv('BEFD_createdData/StabAlphaAUC.csv')
#load packages and functions
library(tidyverse)
library(ggpubr)
library(cowplot)
library(ggpmisc) #for regression lines
library(here)
# data wrangling - remove duplicates created in the AUC loop
stab.auc <- distinct(max, Limit, Model, sensitivity, competition, relAlpha, max, runNumber, species, mean.treat.pi, mean.con.pi, AUC.pi, AUC.RR, AUC.totRR) %>%
group_by(Limit, runNumber, Model) %>%
mutate(MaxAlpha = max(competition)) %>%
ungroup() %>%
mutate(inv_relAlpha = MaxAlpha/competition)
#compare measures
hist(stab.auc$mean.con.pi )
hist(stab.auc$inv_relAlpha)
ggscatter(stab.auc,  y = 'mean.con.pi',x = 'inv_relAlpha', add = 'reg.line', conf.int = T, ylab = 'relat. competitiveness', xlab = 'relat. dominance')  +
stat_cor( label.x = 1)           # Add correlation coefficient
ggsave(plot = last_plot(), file = here('output/Supplement_correlationDominanceAlpha.png'), width = 5, height = 4 )
ggplot(stab.auc, aes(x = species, y = mean.treat.pi, color = species))+
geom_boxplot()+
facet_grid(~Limit)+
scale_color_manual(values = c('#D56060', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
theme(legend.position = 'none')
stab.auc.RAD <- max %>%
group_by(species) %>%
summarise(overall.con.pi = mean(mean.con.pi,na.rm = T)) %>% #calculate mean dom in control
mutate(ranking.by.mean.pi =  rank(dplyr::desc(overall.con.pi)) )%>%
left_join(., stab.auc, by = c('species'))      %>% # add ranking
distinct(species,Limit,Model, runNumber, AUC.pi, AUC.RR,ranking.by.mean.pi, overall.con.pi) %>% #remove duplicates (because of timepoint)
gather(key = 'AUCmetric', value = 'AUC', -Limit, -Model, -species, -runNumber,-ranking.by.mean.pi, -overall.con.pi) %>%
group_by(species, Limit, Model, AUCmetric) %>%
mutate(mean.AUC = mean(AUC, na.rm = T), #mean for each species
sd.AUC = mean(AUC, na.rm = T),
se.AUC = sd.AUC/sqrt(n())) %>%
mutate(trend = ifelse(AUC < 0.1, 'negative', ifelse(AUC >0.1, 'positive', 'neutral')),
mean.trend = ifelse(mean.AUC < 0.1, 'negative', ifelse(mean.AUC >0.1, 'positive', 'neutral')))
#### Figure 3 dominance ~AUC  ####
names(max)
Dom1R<-ggplot(subset(stab.auc, Limit == 'Limit1'), aes(x=mean.con.pi, y=AUC.RR,
col=species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .3, size = 2)+
scale_color_manual(values = c('#68789E', '#68789E', '#68789E', '#68789E', '#68789E'))+
labs(y = 'Absolute contribution to stability', x = "")+
facet_wrap(~Model, ncol = 3)+
scale_y_continuous(limits = c(-1.7, 1.1), breaks = c(-1.5,-1,-0.5,0,0.5,1))+
scale_x_reverse()+
# scale_x_continuous(limits = c(0.4,0), breaks = c(0.4,0.2,0))+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Dom1R
Dom1pi<-ggplot(subset(stab.auc, Limit == 'Limit1'), aes(x=mean.con.pi, y=AUC.pi,
col=species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .3, size = 2)+
scale_color_manual(values = c('#68789E', '#68789E', '#68789E', '#68789E', '#68789E'))+
scale_y_continuous(limits = c(-0.1, 0.1), breaks = c(-0.1,-0.05,0,0.05,0.1))+
scale_x_reverse()+
labs(y = 'Relative contribution to stability', x = " ")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Dom1pi
unique(stab.alpha$species)
Dom2R<-ggplot(subset(stab.auc, Limit == 'Limit2'), aes(x=mean.con.pi, y=AUC.RR,
col=species)) +
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_y_continuous(limits = c(-33, 33), breaks = c(-30,-15,0,15,30))+
scale_x_reverse()+
geom_point(alpha= .3, size = 2)+
geom_hline(yintercept=0, col="grey")+
labs(y = 'Absolute contribution to stability', x = " ")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Dom2R
Dom2pi<-ggplot(subset(stab.auc, Limit == 'Limit2'), aes(x=mean.con.pi, y=AUC.pi,
col=species)) +
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_y_continuous(limits = c(-4, 4), breaks = c(-4,-2,0,2,4))+
scale_x_reverse()+
geom_point(alpha= .3, size = 2)+
geom_hline(yintercept=0, col="grey")+
labs(y = 'Relative contribution to stability', x = "")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 16)) +
theme(legend.position="none")
Dom2pi
Dom3R<-ggplot(subset(stab.auc, Limit == 'Limit3'), aes(x=mean.con.pi, y=AUC.RR,
col=species)) +
geom_point(alpha= .3, size = 2)+
geom_hline(yintercept=0, col="grey")+
scale_color_manual(values = c('#D56060', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_x_reverse()+
scale_y_continuous(limits = c(-30, 25), breaks = c(-30,-20,-10,0,10,20))+
labs(y='Absolute contribution to stability', x = "relative dominance")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(text = element_text(size = 16)) +  theme(legend.position="none")
Dom3R
Dom3pi<-ggplot(subset(stab.auc, Limit == 'Limit3'), aes(x=mean.con.pi, y=AUC.pi,
col=species)) +
geom_point(alpha= .3, size = 2)+
geom_hline(yintercept=0, col="grey")+
scale_color_manual(values = c('#D56060', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
scale_x_reverse()+
scale_y_continuous(limits = c(-3, 2.5), breaks = c(-3,-2,-1,0,1,2))+
labs(y= 'Relative contribution to stability', x = "relative dominance")+
facet_wrap(~Model, ncol = 3)+
theme_bw() +
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(strip.text.x = element_text(color = 'white'),
strip.background =element_rect(fill = 'white', linetype = 0))+
theme(text = element_text(size = 16)) +  theme(legend.position="")
Dom3pi#ggsave(plot = RRpi, 'RRPi.png',width = 8, height = 4)
par(mar=c (5.1, 4.1, 4.1, 2.1))
ggarrange(Dom1R,Dom1pi, Dom2R,Dom2pi,Dom3R,Dom3pi,hjust = -1, ncol = 2, nrow = 3)
ggsave(plot = last_plot(), width = 12, height = 12, file = here('output/Fig.3_Dominance_allDist.png'))
AUC.pi.dom <- max %>%
distinct(mean.con.pi,AUC.pi,Limit,Model,species) %>%
ggplot(., aes(x=mean.con.pi, y=AUC.pi, color = species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .2)+
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
labs(y = 'AUC.pi +- se', x = 'dominance')+
facet_grid(~Limit~Model, scales = 'free_y')+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 12)) +
theme(legend.position="none")
AUC.pi.dom
AUC.RR.dom <- max %>%
distinct(mean.con.pi,AUC.RR,Limit,Model,species) %>%
ggplot(., aes(x=mean.con.pi, y=AUC.RR, color = species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .2)+
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
labs(y = 'AUC.RR +- se', x = 'dominance')+
facet_grid(~Limit~Model, scales = 'free_y')+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 12)) +
theme(legend.position="none")
AUC.RR.dom
#### dominance and alpha ####
AUC.pi.alpha <- max %>%
distinct(inv_relAlpha,relAlpha,AUC.pi,Limit,Model,species) %>%
ggplot(., aes(x=inv_relAlpha, y=AUC.pi, color = species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .2)+
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
labs(y = 'AUC.pi +- se', x = '1/relAlpha - relative competitiveness')+
facet_grid(~Limit~Model, scales = 'free_y')+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 12)) +
theme(legend.position="none")
AUC.pi.alpha
#### dominance and alpha ####
AUC.pi.alpha <- max %>%
distinct(inv_relAlpha,relAlpha,AUC.pi,Limit,Model,species) %>%
ggplot(., aes(x=inv_relAlpha, y=AUC.pi, color = species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .2)+
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
labs(y = 'AUC.pi +- se', x = '1/relAlpha - relative competitiveness')+
facet_grid(~Limit~Model, scales = 'free_y')+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 12)) +
theme(legend.position="none")
#### dominance and alpha ####
names(max)
AUC.pi.alpha <- max %>%
distinct(relAlpha,AUC.pi,Limit,Model,species) %>%
ggplot(., aes(x=relAlpha, y=AUC.pi, color = species)) +
geom_hline(yintercept=0, col="grey")+
geom_point(alpha= .2)+
scale_color_manual(values = c('#68789E', '#BEBEBE', '#BEBEBE', '#BEBEBE', '#BEBEBE'))+
labs(y = 'AUC.pi +- se', x = '1/relAlpha - relative competitiveness')+
facet_grid(~Limit~Model, scales = 'free_y')+
theme_bw() +
theme(strip.background =element_rect(),
strip.text = element_text(size = 12, face = 'bold'))+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+
theme(text = element_text(size = 12)) +
theme(legend.position="none")
AUC.pi.alpha
